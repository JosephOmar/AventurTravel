---
import Layout from "../../../layouts/Layout.astro"
import SliderNav from "../../../components/Main/SliderNav.astro";
import TitleDetails from "../../../components/Details/TitleDetails.astro"
import ContainerDetails from "../../../components/Details/ContainerDetails.astro"
import Description from "../../../components/Details/Description.astro"
import Itinerary from "../../../components/Details/Itinerary.astro"
import DetailsTravel from "../../../components/Details/DetailsTravel.astro";
import Considerations from "../../../components/Details/Considerations.astro";
import Price from "../../../components/Details/Price.astro";
import type { Tour } from "../../../components/InterfaceTour"
import CarouselDetails from "../../../components/Details/CarouselDetails.astro";
import AdditionalServices from "../../../components/Details/AdditionalServices.astro";
import FormTravel from "../../../components/Details/FormTravel.astro";
import CommentsDetails from "../../../components/Details/CommentsDetails.astro";
import TravelTime from "../../../components/Details/TravelTime.astro";

const response = await fetch('https://aventurtravel-api.2.us-1.fl0.io/destinations?tourOption=Tours-Escolares');
const data = await response.json();
const { slug } = Astro.params; 
const destinationSlug = slug?.split("/").slice(-1)[0];
const tour: Tour = data.find((tour:Tour) => {
    const apiSlugDestination = tour.slug.split("/").slice(-1)[0];
    return apiSlugDestination === destinationSlug;
});
if (!tour) return Astro.redirect("/404");
---
<Layout title={tour.title} description={tour.description}>
  <SliderNav image1={tour.imgSlider[0]} image2={tour.imgSlider[1]} image3={tour.imgSlider[2]} image4={tour.imgSlider[3]} h="md:h-[50vh]"/>
  <TitleDetails name={tour.title}></TitleDetails>
  <ContainerDetails>
    <Description description={tour.description} slot="section1"/>
    <TravelTime timetravel={tour.timeTravel}/>
    <Itinerary days={tour.itinerary} slot="section1"/>
    <DetailsTravel details={tour.additional} slot="section1"/>
    <Considerations considerations={tour.considerations} slot="section1"/>
    <Price exchange="PEN" price={tour.price} slot="section2"/>
    <CarouselDetails images={tour.imgCarousel} slot="section2"/>
    <AdditionalServices additionals={tour.additional} slot="section1"/>
  </ContainerDetails>
  <FormTravel place=`${tour.tourOption} ${tour.title}`/>
  <CommentsDetails comments={tour.comments}/>
</Layout>
    
